---
layout: post
title:  Internet Explorer is a harsh mistress
date:   2004-04-15
tags:   [ technology ]
---

<p>So for the past couple of weeks, when I haven&#8217;t been out for Pesach, I&#8217;ve been working on <a href="http://www.w3.org/Style/XSL/" title="Extensible Stylesheet Language Transformations">XSLT</a> scripts for converting an <abbr title="Extensible Markup Language">XML</abbr> description of a workflow, first into <abbr title="HyperText Markup Language">HTML, then into <a href="http://www.w3.org/Graphics/SVG/" title="Scalable Vector Graphics">SVG</a> images. Unfortunately, I have a bit of a problem now integrating the two results, and perhaps the geeks who read this blog can help me, or can point me at someone else who can help me.</abbr> <p><abbr title="HyperText Markup Language">Each workflow has a bunch of tasks. In the HTML file, each task has a nicely formatted box of text describing the various task attributes, with an &#8220;id&#8221; tag. When one task refers to another, there&#8217;s a <code>&lt;a href="http://ropine.com/yesh/article/internet-explorer-is-a-harsh-mistress#TaskName"&gt;link&lt;/a&gt;</code> that does exactly what you&#8217;d expect when I click on it.</abbr></p> <p><abbr title="HyperText Markup Language">Now according to <a href="http://www.w3.org/TR/SVG11/linking.html">chapter 17 of the SVG spec</a>, any piece of SVG content can be turned into a link. So in the SVG translation of the workflow, every task has a <code>&lt;a xlink:href="otherfile.html#TaskName&gt;link&lt;/a&gt;</code> to the corresponding section of the HTML file. Simple, right?</abbr></p> <p><abbr title="HyperText Markup Language">So when I double-click on the SVG file in Windows, <abbr title="Internet Exploit^H^Hrer version 6">IE6</abbr>, and <a href="http://www.adobe.com/svg/viewer/install/main.html">Adobe&#8217;s SVG plugin</a> renders my lovely diagram. When I then click on one of the tasks in the diagram, the browser goes to my HTML page, <em>but doesn&#8217;t scroll down to the particular task that I selected</em>.</abbr></p> <p>Yesterday I spent an hour or two applying my Talmudic skills to <a href="http://www.w3.org/TR/SVG11/">the SVG spec</a>, <a href="http://www.w3.org/TR/xlink/">the XLink spec</a>, and <a href="http://www.carto.net/papers/svg/samples/svg_html.shtml">this crib sheet for embedding SVG in HTML</a>, trying different incantations in my XSLT file, clicking, clicking, clicking, usually with the same disappointing result, sometimes with an even more disappointing result.</p> <p>Then I tried copying both the SVG and HTML files to somewhere underneath my Web root, opened the SVG file in my browser with <code>http:</code> instead of <code>file:</code>, and clicked through. Voila! Everything works. Curse Microsoft for their not-quite-orthogonal interface. Problem solved, or at least worked around, right?</p> <p>Of course not.</p> <p>The fellow who assigned me this project pointed out that my stylesheets, ultimately, will be generating javadoc-like documentation for our clients, and it would be unreasonable to require that in order to read documentation generated from files on their own workstation, they have to run a Web server on that workstation.</p> <p>The best workaround I&#8217;ve found so far is to escape the pound sign in the link, so instead of <code>&lt;a xlink:href="otherfile.html#TaskName&gt;link&lt;/a&gt;</code>, the source code says <code>&lt;a xlink:href="otherfile.html%23TaskName&gt;link&lt;/a&gt;</code>. This will make the link appropriately follow-able when I double-click on the SVG file in Windows Explorer, but <em>not</em> when I view it as a Web page served from my workstation&#8217;s Web server.</p> <p>I suppose this is good enough for now, but it feels like a standards-violating hack that&#8217;s going to stop working as soon as Adobe or Microsoft releases the next version of their software. If I had time to refactor my XSL in a major way, I would probably use the <a href="http://xml.apache.org/batik/svgrasterizer.html">Batik SVG Rasterizer</a> to convert the SVG file into a PNG file, and then use an <a href="http://www.w3.org/TR/html401/struct/objects.html#h-13.6.1">image map</a> to make the tasks on the graph clickable. However, I have it on good authority that our company is associated with these strange people called &#8220;customers&#8221;, and extracting money from them is easier when our software is published according to this thing called a &#8220;schedule&#8221;, so I don&#8217;t know if I have time to redo it this way. Does anyone have any easier-to-implement alternatives?</p> <p>(Well, yes, we could tell our users to get another Web browser, except that <a href="http://mozilla.org/products/mozilla1.x/">Mozilla</a> and <a href="http://mozilla.org/products/firefox/">Firefox</a> both hang when they try to run the Adobe plugin, the &#8220;download SVG-enabled Mozilla&#8221; links from <a href="http://www.mozilla.org/projects/svg/">the Mozilla SVG Project page</a> appear to be dead, <a href="http://www.w3.org/Amaya/">Amaya</a> has a butt-ugly interface and doesn&#8217;t render the SVG very well, and <a href="http://xml.apache.org/batik/svgviewer.html">Squiggle</a> has a butt-ugly interface and can&#8217;t follow links to HTML documents. Give the devil his due: for this purpose, Internet Explorer is the least bad alternative.)</p></p>


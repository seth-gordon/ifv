---
layout: post
title:  Dept. of “you can’t win for losing”
date:   2009-08-10
tags:   [ technology, diary ]
---

<p>I&#8217;ve been trying to protect myself from the headaches of another massive hard-drive failure by backing up our home systems to <a href="http://aws.amazon.com/s3/">Amazon S3</a>, first by using <a href="http://jungledisk.com/">JungleDisk</a>, and more recently by using <a href="http://duplicity.nongnu.org/">duplicity</a>. (JungleDisk is a fine program&#8212;it&#8217;s one of the few pieces of software running on my Linux box that I&#8217;ve put down money for, and I&#8217;ve never regretted doing so&#8212;but the basic version is oriented towards backing up one user&#8217;s personal files, and knows nothing of Unix ownership, file permissions, etc.)</p>

	<p>The one problem with this approach is that we have about 20 GB of music files on our desktop system, and our <span class="caps">DSL</span> connection is only 128 Kbps upstream, so the music stuff is not being backed up as frequently as everything else.</p>

	<p>But this past week, we were on vacation in New York, and my wife and I independently hit on this brilliant idea: start One Great Big Backup right before we leave, and it should be done before we get back.  (Well &#8230; mostly done.  I should have worked out the math first. But that was the least of my problems.)</p>

	<p>So I set One Great Big Backup to kick off at 10:00 a.m. Sunday morning, come back at about 4:30 Friday afternoon (the bus having arrived in Boston an hour and a half late), and discover that our system is even less responsive than it usually is under high load, and the console is printing out disturbing messages regarding the hard drive, containing cheerful messages like this:</p>

	<p><code>SError: { PHYRdyChg CommWake Dispr LinkSeq TrStaTrns }</code></p>

	<p>After a panicked reboot and some more panicked fumbling with <a href="http://linux.die.net/man/8/e2fsck">fsck</a>, I gave up and shut the machine down.</p>

	<p>Did I mention that this is the computer that controls our X10 system for turning lights on and off at appropriate times?</p>

	<p>Anyway, on Saturday night, I did a more sober assessment of the damage, and determined that:</p>

	<ol>
		<li>One Great Big Backup had not finished and seemed hopelessly corrupt, so the music files had not been backed up.</li>
		<li>The most recent backup of our music to JungleDisk had happened, umm, some time in July of 2008.</li>
		<li>Regular daily backups had been going on as expected, so at least the regular desktop files were safe.</li>
		<li>Googling the cheerful messages from the hard drive turned up advice along the lines of &#8220;hard drives are cheap, do you really want to keep using one that&#8217;s flaking out on you?&#8221;</li>
	</ol>

	<p>So today&#8217;s adventures included a journey to <a href="http://www.microcenter.com/">Micro Center</a>, where we picked up</p>

	<ol>
		<li>a Hitachi 500-GB internal <span class="caps">SATA</span> hard drive, on sale</li>
		<li>a Hitachi 640-GB external <span class="caps">USB</span> hard drive, on sale</li>
		<li>an Ubuntu 8.10 LiveCD</li>
	</ol>

	<p>When I tried to install the first of these items, a little nub of plastic broke off the end of the <span class="caps">SATA</span> cable.  Also, the drive came with <em>two</em> machine screws, wheres the drive bay in our desktop machine requires <em>four</em> screws on a drive to keep it in place. Maybe that&#8217;s why these things were on sale.  Hopefully, the Micro Center folks won&#8217;t give us grief about replacing it tomorrow.</p>

	<p>The second one seems to be working so far as well as one might expect, although <span class="caps">VFAT</span>&#8217;s limitations on file names and size make my attempts at recovery and forensics&#8230; well, I&#8217;ve used about as much creativity as I think I can stand right now.</p>

	<p>The third item, though, has worked like a charm: I booted from the CD, plugged in the external drive, mounted the partition that had the music on it, and as far as I can tell, all those files were copied over without a hitch. I would have backed up <a href="https://help.ubuntu.com/community/DataRecovery#Data%20Recovery%20from%20damaged%20filesystem%20or%20drive">disk images</a> from the broken drive to the external one as well, but then I ran into <span class="caps">VFAT</span>&#8217;s 4-GB-per-file limit. See previous comment about creativity.</p>

